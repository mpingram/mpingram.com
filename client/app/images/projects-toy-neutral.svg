<?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 12.0.0, SVG Export Plug-In  -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd" [
	<!ENTITY ns_flows "http://ns.adobe.com/Flows/1.0/">
	<!ENTITY ns_svg "http://www.w3.org/2000/svg">
	<!ENTITY ns_xlink "http://www.w3.org/1999/xlink">
]>
<svg  version="1.1" xmlns="&ns_svg;" xmlns:xlink="&ns_xlink;" xmlns:a="http://ns.adobe.com/AdobeSVGViewerExtensions/3.0/"
	 width="650" height="650" viewBox="-0.5 -0.5 650 650" enable-background="new -0.5 -0.5 650 650" xml:space="preserve">
<defs>
</defs>
<path fill="none" stroke="#000000" d="M648.5,636.5c0,6.627-5.373,12-12,12h-624c-6.627,0-12-5.373-12-12v-624
	c0-6.627,5.373-12,12-12h624c6.627,0,12,5.373,12,12V636.5z"/>
<rect x="9.5" y="9.5" fill="none" width="495" height="630"/>
<text transform="matrix(1 0 0 1 9.5 19.5659)"><tspan x="0" y="0" font-family="'SourceSansPro-Light'" font-size="14">// factory function</tspan><tspan x="0" y="16.8" font-family="'SourceSansPro-Light'" font-size="14">// ============================</tspan><tspan x="0" y="33.6" font-family="'SourceSansPro-Light'" font-size="14">var AcrobatMailMerge =  function(mockApi){</tspan><tspan x="0" y="67.2" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">	</tspan><tspan x="36" y="67.2" font-family="'SourceSansPro-Light'" font-size="14">// DEVELOPMENT</tspan><tspan x="0" y="84" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">	</tspan><tspan x="36" y="84" font-family="'SourceSansPro-Light'" font-size="14">// ---------------------------------</tspan><tspan x="0" y="100.8" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">	</tspan><tspan x="36" y="100.8" font-family="'SourceSansPro-Light'" font-size="14">// injects mock API if it&apos;s passed as an argument</tspan><tspan x="0" y="117.6" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">	</tspan><tspan x="36" y="117.6" font-family="'SourceSansPro-Light'" font-size="14">// to the factory</tspan><tspan x="0" y="134.4" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">	</tspan><tspan x="36" y="134.4" font-family="'SourceSansPro-Light'" font-size="14">if (mockApi) {</tspan><tspan x="0" y="151.2" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">		</tspan><tspan x="72" y="151.2" font-family="'SourceSansPro-Light'" font-size="14">// verify api is ok</tspan><tspan x="0" y="168" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">		</tspan><tspan x="72" y="168" font-family="'SourceSansPro-Light'" font-size="14">if (</tspan><tspan x="85.579" y="168" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="19">	</tspan><tspan x="108" y="168" font-family="'SourceSansPro-Light'" font-size="14">typeof mockApi </tspan><tspan x="199.417" y="168" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="13">	</tspan><tspan x="215.999" y="168" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">	</tspan><tspan x="251.999" y="168" font-family="'SourceSansPro-Light'" font-size="14">!== &apos;object&apos; ||</tspan><tspan x="0" y="184.8" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">					</tspan><tspan x="180" y="184.8" font-family="'SourceSansPro-Light'" font-size="14">mockApi.app </tspan><tspan x="257.894" y="184.8" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="27">	</tspan><tspan x="287.999" y="184.8" font-family="'SourceSansPro-Light'" font-size="14">=== undefined ||</tspan><tspan x="0" y="201.6" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">					</tspan><tspan x="180" y="201.6" font-family="'SourceSansPro-Light'" font-size="14">mockApi.doc </tspan><tspan x="257.067" y="201.6" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="28">	</tspan><tspan x="287.999" y="201.6" font-family="'SourceSansPro-Light'" font-size="14">=== undefined ||</tspan><tspan x="0" y="218.4" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">					</tspan><tspan x="180" y="218.4" font-family="'SourceSansPro-Light'" font-size="14">mockApi.util </tspan><tspan x="253.974" y="218.4" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="31">	</tspan><tspan x="288" y="218.4" font-family="'SourceSansPro-Light'" font-size="14">=== undefined){</tspan><tspan x="0" y="235.2" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">			</tspan><tspan x="108" y="235.2" font-family="'SourceSansPro-Light'" font-size="14">throw new Error(&apos;Incomplete mock API&apos;);</tspan><tspan x="0" y="268.8" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">		</tspan><tspan x="72" y="268.8" font-family="'SourceSansPro-Light'" font-size="14">} else {</tspan><tspan x="0" y="285.6" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">			</tspan><tspan x="108" y="285.6" font-family="'SourceSansPro-Light'" font-size="14">// establish mock API</tspan><tspan x="0" y="302.4" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">			</tspan><tspan x="108" y="302.4" font-family="'SourceSansPro-Light'" font-size="14">var app = mockApi.app;</tspan><tspan x="0" y="319.2" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">			</tspan><tspan x="108" y="319.2" font-family="'SourceSansPro-Light'" font-size="14">var doc = mockApi.doc;</tspan><tspan x="0" y="336" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">			</tspan><tspan x="108" y="336" font-family="'SourceSansPro-Light'" font-size="14">var util = mockApi.util;</tspan><tspan x="0" y="352.8" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">		</tspan><tspan x="72" y="352.8" font-family="'SourceSansPro-Light'" font-size="14">}</tspan><tspan x="0" y="369.6" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">	</tspan><tspan x="36" y="369.6" font-family="'SourceSansPro-Light'" font-size="14">}</tspan><tspan x="0" y="386.4" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">	</tspan><tspan x="36" y="386.4" font-family="'SourceSansPro-Light'" font-size="14">// otherwise, assume we&apos;re running in AcroJS environment</tspan><tspan x="0" y="403.2" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">	</tspan><tspan x="36" y="403.2" font-family="'SourceSansPro-Light'" font-size="14">// and we don&apos;t need to inject anything.</tspan><tspan x="0" y="420" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">	</tspan><tspan x="36" y="420" font-family="'SourceSansPro-Light'" font-size="14">// ----------------------------------</tspan><tspan x="0" y="453.6" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">	</tspan><tspan x="36" y="453.6" font-family="'SourceSansPro-Light'" font-size="14">var self = {};</tspan><tspan x="0" y="487.2" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">	</tspan><tspan x="36" y="487.2" font-family="'SourceSansPro-Light'" font-size="14">// private vars</tspan><tspan x="0" y="504" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">	</tspan><tspan x="36" y="504" font-family="'SourceSansPro-Light'" font-size="14">// ----------------------</tspan><tspan x="0" y="520.8" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">	</tspan><tspan x="36" y="520.8" font-family="'SourceSansPro-Light'" font-size="14">var targetFieldsRegexNoFlags = /&lt;&lt;(.+?)&gt;&gt;/;</tspan><tspan x="0" y="537.6" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">	</tspan><tspan x="36" y="537.6" font-family="'SourceSansPro-Light'" font-size="14">var targetFieldsRegex = new RegExp(targetFieldsRegexNoFlags,&apos;g&apos;);</tspan><tspan x="0" y="554.4" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">	</tspan><tspan x="36" y="554.4" font-family="'SourceSansPro-Light'" font-size="14">var conditionalBlocksRegex = /\[[^\[]*?&lt;&gt;[^\]]*?\]|&lt;|&gt;|\[|\]/g;</tspan><tspan x="0" y="588" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">	</tspan><tspan x="36" y="588" font-family="'SourceSansPro-Light'" font-size="14">// flag marks whether multiple fields each map to one record (false)</tspan><tspan x="0" y="604.799" font-family="'SourceSansPro-Light'" font-size="14" letter-spacing="33">	</tspan><tspan x="36" y="604.799" font-family="'SourceSansPro-Light'" font-size="14">// or multiple fields map to multiple records (true)</tspan></text>
</svg>
